<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Razorpay Integration Test - Delhi Chicken Brothers</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-2xl font-bold text-center mb-6 text-red-600">Razorpay Integration Test</h1>
        
        <div class="space-y-4">
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                <h3 class="font-semibold text-green-800">‚úÖ Backend Test</h3>
                <p class="text-sm text-green-600">Server is running and creating Razorpay orders successfully</p>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 class="font-semibold text-blue-800">üîß Integration Status</h3>
                <ul class="text-sm text-blue-600 space-y-1">
                    <li>‚Ä¢ Razorpay checkout.js loaded: <span id="razorpay-status" class="font-semibold">Checking...</span></li>
                    <li>‚Ä¢ Supabase client: <span id="supabase-status" class="font-semibold">Checking...</span></li>
                    <li>‚Ä¢ Cart functionality: <span id="cart-status" class="font-semibold">Checking...</span></li>
                </ul>
            </div>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <h3 class="font-semibold text-yellow-800">üìã Test Steps</h3>
                <ol class="text-sm text-yellow-700 space-y-2">
                    <li>1. Open <a href="index.html" class="underline text-blue-600">index.html</a></li>
                    <li>2. Add items to cart</li>
                    <li>3. Open cart sidebar</li>
                    <li>4. Select UPI payment method</li>
                    <li>5. Click "Proceed to Checkout"</li>
                    <li>6. Complete payment in Razorpay modal</li>
                    <li>7. Verify redirection to order status page</li>
                </ol>
            </div>
            
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                <h3 class="font-semibold text-purple-800">üîç Quick Test</h3>
                <button onclick="testBackend()" class="w-full bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 transition-colors">
                    Test Backend Connection
                </button>
                <div id="test-result" class="mt-2 text-sm"></div>
            </div>
        </div>
    </div>

    <script>
        // Check if Razorpay is available
        if (typeof Razorpay !== 'undefined') {
            document.getElementById('razorpay-status').textContent = '‚úÖ Available';
            document.getElementById('razorpay-status').className = 'font-semibold text-green-600';
        } else {
            document.getElementById('razorpay-status').textContent = '‚ùå Not loaded';
            document.getElementById('razorpay-status').className = 'font-semibold text-red-600';
        }

        // Check if Supabase is available
        if (typeof supabase !== 'undefined') {
            document.getElementById('supabase-status').textContent = '‚úÖ Available';
            document.getElementById('supabase-status').className = 'font-semibold text-green-600';
        } else {
            document.getElementById('supabase-status').textContent = '‚ùå Not loaded';
            document.getElementById('supabase-status').className = 'font-semibold text-red-600';
        }

        // Check cart functionality
        if (typeof triggerRazorpayCheckout !== 'undefined') {
            document.getElementById('cart-status').textContent = '‚úÖ Available';
            document.getElementById('cart-status').className = 'font-semibold text-green-600';
        } else {
            document.getElementById('cart-status').textContent = '‚ùå Not loaded';
            document.getElementById('cart-status').className = 'font-semibold text-red-600';
        }

        async function testBackend() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<div class="text-blue-600">Testing backend connection...</div>';
            
            try {
                const response = await fetch('https://dcb-pos-final.onrender.com/create-order', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 10000 })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.innerHTML = `
                        <div class="text-green-600">
                            ‚úÖ Backend working!<br>
                            Order ID: ${data.orderId}<br>
                            Key: ${data.key}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `<div class="text-red-600">‚ùå Backend error: ${response.status}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="text-red-600">‚ùå Connection failed: ${error.message}</div>`;
            }
        }
    </script>
</body>
